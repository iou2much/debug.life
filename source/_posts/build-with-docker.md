title: 用Docker容器编译软件
date: 2016-02-20 09:38:24
tags: 
 - Docker
description: 本文介绍如何使用Docker来编译各种语言开发的软件
toc: true
category: Docker
---

## 为什么要用容器中的构建工具

### 开箱即用

对编译型语言的开发人员来说，编译构建是必不可少的一门基础课，从简单的 gcc / javac 等编译命令，到强大的 make / maven / gradle 等构建工具，这些工具都是各种语言的开发人员应该熟悉的。

但是对一门语言的初学者来说，他很可能不知道如何安装配置这些构建工具，即使非常简单，但也可能因为漏配某些环境变量而失败。

我的设想中，Docker这个工具会成为搭建开发环境的技术标准，因为它确实能给我们带来它一直宣传着的那些优点：

- 统一开发/测试/生产环境：通过Docker搭建的开发环境来作为团队规范，使每个成员的环境一致，一来降低新成员加入的难度，二来减少因为开发/测试/生产环境不统一引起的bug。

- 隔离性强，对宿主系统无侵入性：只需要拉取镜像到开发者的机器上，一键安装/移除，防止使开发者的机器越用越乱（曾经见过有同事的开发机上装了五六个版本的tomcat，Eclipse的项目配置乱得不知道用的是哪个路径的tomcat，定位了半天才找到问题)

- 一键安装，快速部署，轻量级：Docker黑盒般的镜像隐藏掉了大部分细节，对普通开发者来说是一种便利。

### 多版本共存

随着我们接触到的项目越来越多，即使是编译构建这种入门级的日常任务也可能会难倒我们，我们免不了会接触到一些麻烦的情况——在我们已经装好的编译器(或构建工具)版本与项目需要的特定构建工具版本不兼容。

某个Java老项目只支持旧版JDK，构建时要特地下载一个旧版的JDK并且修改环境变量。

在Linux上编译安装某些老软件的时候，有时会遇到报错说gcc或者make的版本太高，这种情况非常折腾，降级gcc可能要降级glibc，那意味着整个系统都有可能受到影响。


gcc / make / golang

docker run --rm -v "$PWD":/usr/src/myapp -w /usr/src/myapp golang go build -v

javac / maven / gradle

scala